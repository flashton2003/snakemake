todo_list = ['10572-SRR5709738', '10573-SRR5709739', '10576-SRR5709742', '10579-SRR5709745', '10581-SRR5709747', '10582-SRR5709748', '10583-SRR5709749', '10584-SRR5709750', '10587-SRR5709753', '10589-SRR5709755', '10591-SRR5709757', '10594-SRR5709760', '10596-SRR5709762', '10599-SRR5709765', '10601-SRR5709767', '10602-SRR5709768', '10603-SRR5709769', '10605-SRR5709771', '10606-SRR5709772', '10607-SRR5709773', '10609-SRR5709776', '10610-SRR5709777', '10612-SRR5709779', '10613-SRR5709780', '10617-SRR5709784', '10618-SRR5709785', '10619-SRR5709786', '10621-SRR5709788', '10623-SRR5709790', '10625-SRR5709792', '10626-SRR5709793', '10627-SRR5709794', '10628-SRR5709795', '10629-SRR5709796', '10631-SRR5709798', '10633-SRR5709800', '10637-SRR5709804', '10638-SRR5709805', '10640-SRR5709807', '10644-SRR5709811', '10645-SRR5709812', '10646-SRR5709813', '10649-SRR5709816', '10651-SRR5709818', '10652-SRR5709819', '10653-SRR5709820', '10655-SRR5709822', '10656-SRR5709823', '10660-SRR5709827', '10667-SRR5709834', '10669-SRR5709836', '10671-SRR5709838', '10673-SRR5709840', '10681-SRR5709848', '10684-SRR5709852', '10685-SRR5709853', '10686-SRR5709854', '10688-SRR5709856', '10689-SRR5709857', '10695-SRR5709864', '10696-SRR5709865', '10698-SRR5709868', '10699-SRR5709870', '10701-SRR5709872', '10703-SRR5709874', '10704-SRR5709875', '10705-SRR5709876', '10706-SRR5709877', '10708-SRR5709879', '10711-SRR5709882', '10714-SRR5709885', '10715-SRR5709886', '10716-SRR5709887', '10720-SRR5709891', '10728-SRR5709899', '10730-SRR5709901', '10732-SRR5709903', '10734-SRR5709905', '10735-SRR5709906', '10737-SRR5709908', '10738-SRR5709909', '10739-SRR5709910', '10740-SRR5709911', '10747-SRR5709918', '10748-SRR5709919', '10750-SRR5709921', '10752-SRR5709923', '10758-SRR5709929', '10761-SRR5709932', '10762-SRR5709933', '10763-SRR5709934', '10768-SRR5709939', '10769-SRR5709940', '10771-SRR5709942', '10773-SRR5709945', '10774-SRR5709946', '10776-SRR5709948', '10778-SRR5709951', '10779-SRR5709953', '10781-SRR5709955', '10784-SRR5709958', '10786-SRR5709961', '10787-SRR5709962', '10788-SRR5709963', '10789-SRR5709964', '10801-SRR5709976', '10802-SRR5709978', '10813-SRR5709989', '10817-SRR5709993', '10818-SRR5709994', '10819-SRR5709995', '10821-SRR5709997', '10824-SRR5710000', '10825-SRR5710001', '10828-SRR5710005', '10829-SRR5710006', '10832-SRR5710010', '10833-SRR5710011', '10836-SRR5710014', '10840-SRR5710018', '10842-SRR5710020', '10847-SRR5710027', '10848-SRR5710028', '10849-SRR5710029', '10851-SRR5837706', '10853-SRR5837708', '10854-SRR5837709', '10857-SRR5837712', '10858-SRR6480313', '10859-SRR6480314', '10861-SRR6480316', '10870-SRR6480325', '10871-SRR6480326', '10872-SRR6480327', '10874-SRR6480329', '10877-SRR6480332', '10879-SRR6480334', '10882-SRR6480337', '10898-SRR6480353', '10903-SRR6480358', '10904-SRR6480359', '10905-SRR6480360', '10910-SRR6480365', '10911-SRR6480366', '10912-SRR6480367', '10914-SRR6480369', '10917-SRR6480372', '10918-SRR6480373', '10928-SRR6480383', '10933-SRR6480388', '10939-SRR6480394', '10942-SRR6480397', '10946-SRR6480401', '10952-SRR6480407', '10961-SRR6480416', '10965-SRR6480420', '10966-SRR6480421', '10969-SRR6480424', '10971-SRR6480426', '10979-SRR6480434', '10987-SRR6480442', '10988-SRR6480443', '10998-SRR6480453', '11004-SRR6480459', '11006-SRR6480461', '11019-SRR6480474', '11021-SRR6480476', '11022-SRR6480477', '11024-SRR6480479', '11028-SRR6480483', '11032-SRR6480487', '11033-SRR6480488', '11037-SRR6480492', '11042-SRR6480497', '11046-SRR6480501', '11049-SRR6480504', '11051-SRR6480506', '11052-SRR6480507', '11059-SRR6480514', '11062-SRR6480517', '11067-SRR6480522', '11071-SRR6480526', '11078-SRR6480533', '11086-SRR6480541', '11088-SRR6480543', '11090-SRR6480545', '11095-SRR6480550', '11097-SRR6480552', '11100-SRR6480555', '11110-SRR6480565', '11115-SRR6480570', '11119-SRR6480574', '11128-SRR6480583', '11129-SRR6480584', '11134-SRR6480589', '11136-SRR6480591', '11157-SRR6480612', '11158-SRR6480613', '11174-SRR6480629', '11176-SRR6480631', '11177-SRR6480632', '11224-ERR234098', '11226-ERR234100', '11234-ERR234108', '11235-ERR234109', '11238-ERR234112', '11240-ERR234114', '11243-ERR234117', '11248-ERR234122', '11249-ERR234123', '11250-ERR234124', '11255-ERR234129', '11256-ERR234130', '11257-ERR234131', '11258-ERR234132', '11267-ERR234141', '11279-ERR234153', '11283-ERR234157', '11291-ERR234165', '11292-ERR234166', '11293-ERR234167', '11294-ERR234168', '11304-ERR234178', '11305-ERR234179', '11307-ERR234181', '11308-ERR234182', '11315-ERR234189', '11316-ERR234190', '11317-ERR234191', '11319-ERR234193', '11320-ERR234194', '11321-ERR234195', '11331-ERR234205', '11333-ERR234207', '11334-ERR234208', '11336-ERR234210', '11339-ERR234213', '11341-ERR234216', '11347-ERR234234', '11350-ERR234237', '11355-ERR234242', '11362-ERR234249', '11363-ERR234250', '11365-ERR234252', '11366-ERR234253', '11375-ERR234262', '11377-ERR234264', '11383-ERR234270', '11385-ERR234272', '11386-ERR234273', '11390-SRR1710060', '11391-SRR1710061', '11392-SRR1710062', '11393-SRR1710063', '11395-SRR1710065', '11407-SRR1710077', '11408-SRR1710078', '11409-SRR1710079', '11411-SRR1710081', '11412-SRR1710082', '11414-SRR1710084', '11418-SRR1710088', '11425-SRR1710095', '11426-SRR1710096', '11431-SRR1710101', '11432-SRR1710102', '11433-SRR1710103', '11434-SRR1710104', '11436-SRR1710106', '11437-SRR1710107', '11438-SRR1710108', '11442-SRR1710112', '11446-ERR718201', '11451-ERR718220', '11455-ERR718229', '11457-ERR718233', '11460-ERR718237', '11464-ERR718257', '11466-ERR718260', '11470-ERR718268', '11471-ERR718270', '11473-ERR718278', '11474-ERR718283', '11477-ERR718287', '11482-ERR718301', '11485-ERR718310', '11486-ERR718315', '11488-ERR718322', '11489-ERR718323', '11490-ERR718326', '11492-ERR718328', '11493-ERR718329', '11496-ERR718334', '11497-ERR718336', '11499-ERR718341', '11501-ERR718344', '11503-ERR718348', '11504-ERR718353', '11507-ERR718358', '11508-ERR718360', '11509-ERR718362', '11511-ERR718366', '11512-ERR718367', '11514-ERR718371', '11515-ERR718374', '11516-ERR718375', '11517-ERR718376', '11519-ERR718381', '11521-ERR718386', '11523-ERR718388', '11524-ERR718389', '11526-ERR718394', '11527-ERR718395', '11530-ERR718402', '11537-ERR718419', '11539-ERR718422', '11541-ERR718428', '11543-ERR718436', '11547-ERR718441', '11548-ERR718445', '11550-ERR718448', '11551-ERR718449', '11552-ERR718451', '11553-ERR718452', '11554-ERR718458', '11555-ERR718461', '11558-ERR718467', '11561-ERR718473', '11562-ERR718481', '11565-ERR718489', '11571-ERR718502', '11572-ERR718512', '11573-ERR718514', '11574-ERR718520', '11577-ERR718527', '11580-ERR718533', '11583-ERR718538', '11586-ERR718543', '11587-ERR718544', '11588-ERR718547', '11589-ERR718549', '11591-ERR718552', '11592-ERR718553', '11594-ERR718555', '11597-ERR718562', '11602-ERR751660', '11604-ERR751669', '11605-ERR751673', '11606-ERR751676', '11609-ERR751681', '11612-ERR751690', '11614-ERR751703', '11618-ERR751712', '11621-ERR751722', '11622-ERR751724', '11623-ERR751726', '11628-ERR751738', '11633-ERR751749', '11640-ERR751765', '11641-ERR751769', '11643-ERR751772', '11644-ERR751777', '11647-ERR751780', '11648-ERR751783', '11652-ERR751795', '11654-ERR751803', '11655-ERR751806', '11657-ERR751817', '11659-ERR751823', '11663-ERR751836', '11664-ERR751841', '11666-ERR751843', '11670-ERR751853', '11671-ERR751857', '11673-ERR751861', '11679-ERR751875', '11681-ERR751878', '11687-ERR751892', '11688-ERR751897', '11691-ERR751907', '11692-ERR751909', '11693-ERR751914', '11696-ERR751918', '11697-ERR751921', '11703-ERR751931', '11706-ERR751938', '11709-ERR751951', '11710-ERR751953', '11711-ERR751956', '11714-ERR751961', '11715-ERR751962', '11721-ERR751971', '11722-ERR751974', '11723-ERR751976', '11724-ERR751980', '11725-ERR751982', '11728-ERR751986', '11730-ERR751990', '11735-ERR751999', '11736-ERR752000', '11738-ERR752005', '11739-ERR752006', '11743-ERR752012', '11746-ERR752019', '11747-ERR752022', '11748-ERR752026', '11751-ERR752037', '11752-ERR752039', '11753-ERR752044', '11756-ERR752054', '11757-ERR752058', '11758-ERR752059', '11762-ERR752067', '11763-ERR752068', '11764-ERR752069', '11765-ERR752071', '11768-ERR752075', '11769-ERR752079', '11770-ERR752081', '11771-ERR752083', '11772-ERR752085', '11773-ERR752090', '11775-ERR752093', '11779-ERR752101', '11783-ERR752114', '11785-ERR752119', '11786-ERR752122', '11787-ERR752124', '11790-ERR752133', '11791-ERR752134', '11794-ERR752150', '11797-ERR752158', '11800-ERR752161', '11804-ERR752166', '11805-ERR752168', '11806-ERR752170', '11808-ERR752177', '11810-ERR752183', '11811-ERR752185', '11812-ERR752186', '11817-ERR752197', '11818-ERR752198', '11820-ERR752205', '11821-ERR752207', '11822-ERR752209', '11823-ERR752213', '11826-ERR752219', '11827-ERR752226', '11830-ERR752237', '11831-ERR752238', '11832-ERR752240', '11834-ERR752247', '11836-ERR752250', '11838-ERR752263', '11839-ERR752267', '11840-ERR752275', '11841-ERR752284', '11842-ERR752285', '11845-ERR752291', '11846-ERR767958', '11849-ERR767964', '11850-ERR767965', '11851-ERR767966', '11852-ERR767967', '11855-ERR767975', '11857-ERR767977', '11858-ERR767979', '11859-ERR767980', '11860-ERR767981', '11861-ERR767985', '11865-ERR767993', '11867-ERR767997', '11870-ERR768000', '11872-ERR768003', '11873-ERR768005', '11875-ERR768007', '11876-ERR768008', '11877-ERR768010', '11878-ERR768011', '11879-ERR768013', '11884-ERR768021', '11888-ERR768033', '11889-ERR768035', '11893-ERR768041', '11894-ERR768049', '11897-ERR775758', '11898-ERR775759', '11903-ERR775770', '11904-ERR775778', '11905-ERR775779', '11906-ERR775780', '11909-ERR775783', '11910-ERR775786', '11912-ERR775790', '11913-ERR775792', '11914-ERR775795', '11915-ERR775796', '11917-ERR775798', '11920-ERR846991', '11921-ERR846994', '11922-ERR846998', '11924-SRR671720', '11927-SRR671723', '11928-SRR671724', '11930-SRR671726', '11935-SRR671731', '11936-SRR671732', '11938-SRR671734', '11942-SRR671738', '11943-SRR671739', '11946-SRR671742', '11947-SRR671743', '11951-SRR671747', '11952-SRR671748', '11959-SRR671755', '11960-SRR671756', '11963-SRR671759', '11965-SRR671761', '11969-SRR671765', '11975-SRR671771', '11981-SRR671777', '11983-SRR671779', '11987-SRR671783', '11990-SRR671786', '11996-SRR671792', '11998-SRR671794', '11999-SRR671795', '12000-SRR671796', '12001-SRR671797', '12005-SRR671801', '12007-SRR671803', '12008-SRR671804', '12010-SRR671806', '12013-SRR671809', '12016-SRR671812', '12017-SRR671813', '12019-SRR671815', '12021-SRR671817', '12023-SRR671819', '12030-SRR671826', '12032-SRR671828', '12034-SRR671830', '12041-SRR671837', '12043-SRR671839', '12044-SRR671840', '12046-SRR671842', '12048-SRR671844', '12049-SRR671845', '12051-SRR671847', '12053-SRR671849', '12058-SRR671854', '12059-SRR671855', '12060-SRR671856', '12061-SRR671857', '12067-SRR671863', '12069-SRR671865', '12071-SRR671867', '12073-SRR671869', '12075-SRR671871', '12077-SRR671873', '12080-SRR671876', '12081-SRR671877', '12089-ERR171159', '12090-ERR171160', '12091-ERR171161', '12092-ERR171162', '12093-ERR171163', '12096-ERR983228', '12097-ERR983229', '12098-ERR983230', '12099-ERR983231', '12101-ERR983233', '12105-ERR983237', '12106-ERR983238', '12107-ERR983239', '12108-ERR983240', '12111-SRR5520572', '12112-SRR5520573', '12115-SRR5520596', '12117-SRR5520599', '12118-SRR5520600', '12120-SRR5520605', '12122-SRR5520608', '12124-SRR5520615', '12128-SRR5525983', '12129-SRR5525984', '12130-SRR5525985', '12131-SRR5525986', '12132-SRR5525987', '12133-SRR5525995', '12134-SRR5525996', '12135-SRR5525997', '12136-SRR5525998', '12138-SRR5526143', '12139-SRR5526157', '12142-SRR5526351', '12146-SRR5526696', '12147-SRR5526775', '12149-SRR5526784', '12151-SRR5526787', '12152-SRR5526788', '12153-SRR5526839', '12157-SRR5526844', '12159-SRR5526846', '12162-SRR5526904', '12164-SRR5526915', '12165-SRR5526916', '12170-SRR5527177', '12171-SRR5527178', '12172-SRR5527179', '12174-SRR5527198', '12175-SRR5527199', '12176-SRR5527200', '12178-SRR5527202', '12180-SRR5533130', '12184-SRR5533152', '12190-SRR5548263', '12193-SRR5550936', '12194-SRR5551225', '12195-SRR5551477', '12200-SRR5552263', '12202-SRR5552377', '12204-SRR5552458', '12206-SRR5552560', '12208-SRR5552562', '12341-ERR2179834', '12343-ERR2179836', '12346-ERR2179839', '12347-ERR2179840', '12348-ERR2179841', '12354-ERR2179847', '12365-ERR2179858', '12367-ERR2179860', '12371-ERR550644', '12372-ERR550658', '12373-ERR550659', '12378-ERR550777', '12379-ERR550778', '12383-ERR550887', '12385-ERR550927', '12386-ERR550940', '12387-ERR550941', '12390-ERR550957', '12395-ERR551086', '12399-ERR551159', '12403-ERR551185', '12404-ERR551201', '12405-ERR551212', '12407-ERR551225', '12409-ERR551305', '12410-ERR551311', '12411-ERR551360', '12414-ERR551369', '12415-ERR551370', '12416-ERR551412', '12417-ERR551494', '12421-ERR551556', '12426-ERR551636', '12427-ERR551638', '12428-ERR551680', '12434-ERR551804', '12435-ERR551805', '12437-ERR551821', '12443-ERR551928', '12447-ERR551944', '12448-ERR551945', '12450-ERR551957', '12458-ERR551990', '12462-ERR552141', '12466-ERR552219', '12467-ERR552331', '12469-ERR552429', '12472-ERR552479', '12474-ERR552493', '12476-ERR552549', '12477-ERR552550', '12478-ERR552555', '12479-ERR552580', '12484-ERR552689', '12487-ERR552755', '12488-ERR552760', '12491-ERR552838', '12495-ERR552910', '12496-ERR552911', '12498-ERR552939', '12500-ERR552949', '12501-ERR552954', '12502-ERR553068', '12503-ERR553081', '12504-ERR553082', '12505-ERR553086', '12506-ERR553098', '12507-ERR553107', '12509-ERR553139', '12510-ERR553156', '12512-ERR553171', '12521-ERR553313', '14193-ERR400545']
root_dir = '/home/ubuntu/external_tb/oucru_robot'
## something about tb_profiler and move_output rules are ambiguous, so have to specify rule order

ruleorder: tb_profiler > move_output

## first rule that runs, checks everything has finished
## somehow (?) propagates todo_list up the DAG
rule all:
    input:
        expand('{root_dir}/{sample}/tb_profiler/{sample}.json', root_dir = root_dir, sample = todo_list)
        #expand('{sample}.json', sample = todo_list)

## sample comes from rule all
## in shell, need to use wildcards.sample instead of sample
## wildcards is the thing in the {} in input and output (?)
rule tb_profiler:
    input:
        bam = '/home/ubuntu/external_tb/oucru_robot/{sample}/phenix_bbduk/{sample}.bam'
    output:
        '{sample}.json'
    #group:
    #    'run_n_move'
    shell:
        'tb-profiler lineage -a {input.bam} -p {wildcards.sample}'


rule move_output:
    input:
        '{sample}.json'
    output:
        '/home/ubuntu/external_tb/oucru_robot/{sample}/tb_profiler/{sample}.json'
    #group:
    #    'run_n_move'
    shell:
        'mv {wildcards.sample}.json /home/ubuntu/external_tb/oucru_robot/{wildcards.sample}/tb_profiler/{wildcards.sample}.json'
